#!/usr/bin/env python
import reredux

from argparse import ArgumentParser

parser=ArgumentParser()

parser.add_argument('batch_system',help='batch system')
parser.add_argument('run',help='run identifier')
parser.add_argument('--missing',action='store_true',
                    help='only do missing splits')
#parser.add_argument('-w','--walltime',default='04:00',
#                    help='walltime for lsf')

def main():
    args = parser.parse_args()

    if args.batch_system=='lsf':
        cls = reredux.batch.LSFMaker
    elif args.batch_system=='slr':
        cls = reredux.batch.SLRMaker
    else:
        raise ValueError("bad batch system: '%s'" % args.batch_system)

    maker = cls(args.run, missing=args.missing)
    maker.write_scripts()

main()
